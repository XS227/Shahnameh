<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Shahnameh Game | Web3 Strategy &amp; Community Hub</title>
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
        href="https://fonts.googleapis.com/css2?family=Baloo+2:wght@400;500;600;700&family=Outfit:wght@300;400;500;600;700&display=swap"
        rel="stylesheet"
    />
    <style>
        :root {
            color-scheme: dark light;
            --bg: #0b0915;
            --bg-soft: rgba(21, 17, 45, 0.9);
            --surface: rgba(22, 18, 58, 0.78);
            --primary: #f97316;
            --secondary: #38bdf8;
            --highlight: #facc15;
            --text: #f8fafc;
            --text-muted: rgba(248, 250, 252, 0.78);
            --glass: rgba(16, 13, 35, 0.65);
        }

        *, *::before, *::after {
            box-sizing: border-box;
        }

        body {
            margin: 0;
            font-family: 'Outfit', 'Segoe UI', system-ui, sans-serif;
            background: radial-gradient(circle at 15% 20%, rgba(248, 250, 252, 0.08), transparent 45%),
                radial-gradient(circle at 85% 15%, rgba(56, 189, 248, 0.18), transparent 40%),
                radial-gradient(circle at 70% 80%, rgba(249, 115, 22, 0.18), transparent 50%),
                var(--bg);
            color: var(--text);
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            position: relative;
            overflow-x: hidden;
        }

        body::before {
            content: "";
            position: fixed;
            inset: 0;
            background-image: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" width="400" height="400" viewBox="0 0 400 400"><defs><linearGradient id="g" x1="0%" y1="0%" x2="100%" y2="100%"><stop offset="0%" stop-color="%23f97316" stop-opacity="0.18"/><stop offset="100%" stop-color="%2338bdf8" stop-opacity="0.12"/></linearGradient></defs><g fill="none" stroke="url(%23g)" stroke-width="2" stroke-linecap="round" stroke-dasharray="6 14" opacity="0.35"><path d="M30 120Q120 40 210 120T390 120"/><path d="M10 260Q140 170 260 260T410 260"/><path d="M40 360Q200 260 360 360"/></g><g fill="%23facc15" opacity="0.35"><circle cx="70" cy="90" r="2"/><circle cx="210" cy="60" r="3"/><circle cx="320" cy="140" r="2.5"/><circle cx="110" cy="220" r="3"/><circle cx="260" cy="320" r="2.5"/><circle cx="50" cy="310" r="2"/></g></svg>');
            background-repeat: repeat;
            mix-blend-mode: screen;
            pointer-events: none;
            opacity: 0.65;
            z-index: 0;
        }

        header {
            position: relative;
            overflow: hidden;
        }

        .hero {
            position: relative;
            max-width: 1200px;
            margin: 0 auto;
            padding: clamp(3.5rem, 6vw, 5.5rem) clamp(1.5rem, 5vw, 3.5rem);
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 3.5rem;
            align-items: center;
            z-index: 1;
        }

        .hero::after {
            content: "";
            position: absolute;
            inset: 12% 10% auto 55%;
            height: clamp(240px, 40vw, 420px);
            background: radial-gradient(circle at 30% 30%, rgba(250, 204, 21, 0.8), transparent 65%),
                radial-gradient(circle at 70% 70%, rgba(56, 189, 248, 0.6), transparent 70%);
            filter: blur(45px);
            opacity: 0.45;
            pointer-events: none;
        }

        .hero-copy h1 {
            font-family: 'Baloo 2', cursive;
            font-size: clamp(3rem, 7vw, 4.5rem);
            line-height: 1.08;
            margin: 0 0 1.2rem;
            color: var(--highlight);
            text-shadow: 0 18px 45px rgba(14, 11, 31, 0.55);
        }

        .hero-copy p {
            font-size: clamp(1.05rem, 2.3vw, 1.2rem);
            color: var(--text-muted);
            margin-bottom: 2.4rem;
            max-width: 60ch;
        }

        .cta-row {
            display: flex;
            flex-wrap: wrap;
            gap: 1rem;
        }

        .button {
            display: inline-flex;
            align-items: center;
            gap: 0.6rem;
            padding: 0.95rem 1.85rem;
            border-radius: 999px;
            background: var(--secondary);
            color: #020617;
            font-weight: 600;
            text-decoration: none;
            transition: transform 150ms ease, box-shadow 200ms ease;
            box-shadow: 0 18px 40px -15px rgba(56, 189, 248, 0.85);
        }

        .button svg {
            width: 1.1em;
            height: 1.1em;
        }

        .button.secondary {
            background: transparent;
            border: 2px solid rgba(248, 250, 252, 0.35);
            color: var(--text);
            box-shadow: none;
            backdrop-filter: blur(10px);
            background-color: rgba(8, 11, 27, 0.35);
        }

        .button:hover,
        .button:focus-visible {
            transform: translateY(-3px);
            box-shadow: 0 26px 48px -20px rgba(56, 189, 248, 0.95);
        }

        .button.secondary:hover,
        .button.secondary:focus-visible {
            border-color: var(--secondary);
            color: var(--secondary);
        }

        .hero-visual {
            position: relative;
            min-height: 360px;
            border-radius: 36px;
            overflow: hidden;
            background: linear-gradient(145deg, rgba(56, 189, 248, 0.35), rgba(249, 115, 22, 0.3));
            box-shadow: 0 25px 60px -25px rgba(12, 10, 31, 0.65);
            display: flex;
            align-items: center;
            justify-content: center;
            isolation: isolate;
        }

        .hero-visual::before,
        .hero-visual::after {
            content: "";
            position: absolute;
            inset: 0;
            background-size: cover;
            background-position: center;
            opacity: 0.25;
        }

        .hero-visual::before {
            background-image: url('https://images.unsplash.com/photo-1469474968028-56623f02e42e?auto=format&fit=crop&w=1200&q=80');
        }

        .hero-visual::after {
            mix-blend-mode: screen;
            background: radial-gradient(circle at 25% 25%, rgba(250, 204, 21, 0.7), transparent 55%),
                radial-gradient(circle at 80% 70%, rgba(56, 189, 248, 0.7), transparent 65%);
        }

        .hero-card {
            position: relative;
            width: min(340px, 78%);
            padding: 2.2rem;
            border-radius: 24px;
            background: rgba(7, 11, 28, 0.76);
            border: 1px solid rgba(248, 250, 252, 0.2);
            box-shadow: 0 18px 45px -22px rgba(7, 11, 28, 0.9);
            backdrop-filter: blur(16px);
        }

        .hero-card h2 {
            font-family: 'Baloo 2', cursive;
            font-size: 1.3rem;
            margin: 0 0 0.85rem;
            color: var(--highlight);
        }

        .hero-card p {
            margin: 0;
            font-size: 0.98rem;
            color: var(--text-muted);
        }

        section {
            padding: clamp(3rem, 5vw, 4.5rem) clamp(1.5rem, 5vw, 3.5rem);
            position: relative;
        }

        .section-inner {
            max-width: 1100px;
            margin: 0 auto;
        }

        .section-title {
            font-family: 'Baloo 2', cursive;
            font-size: clamp(1.8rem, 4.5vw, 2.6rem);
            color: var(--highlight);
            margin: 0 0 2.5rem;
            text-align: center;
            text-shadow: 0 12px 32px rgba(9, 7, 24, 0.6);
        }

        .feature-grid {
            display: grid;
            gap: 1.8rem;
        }

        @media (min-width: 720px) {
            .feature-grid {
                grid-template-columns: repeat(3, minmax(0, 1fr));
            }
        }

        .feature-card {
            position: relative;
            padding: 1.8rem;
            border-radius: 24px;
            background: var(--glass);
            border: 1px solid rgba(248, 250, 252, 0.16);
            box-shadow: 0 18px 55px -28px rgba(6, 5, 19, 0.85);
            overflow: hidden;
        }

        .feature-card::before {
            content: "";
            position: absolute;
            width: 140%;
            height: 140%;
            top: -80%;
            left: -40%;
            background: radial-gradient(circle, rgba(56, 189, 248, 0.22), transparent 60%);
            transform: rotate(8deg);
            opacity: 0.9;
        }

        .feature-card h3 {
            position: relative;
            margin: 0 0 0.75rem;
            font-family: 'Baloo 2', cursive;
            font-size: 1.4rem;
            color: var(--secondary);
        }

        .feature-card p,
        .feature-card ul {
            position: relative;
            margin: 0;
            color: var(--text-muted);
            line-height: 1.7;
            font-size: 0.98rem;
        }

        .feature-card ul {
            padding-left: 1.1rem;
            margin-top: 0.6rem;
        }

        .feature-card li {
            margin-bottom: 0.4rem;
        }

        .timeline {
            display: grid;
            gap: 1.5rem;
            margin-top: 2.5rem;
        }

        .timeline-step {
            position: relative;
            padding: 1.6rem 1.6rem 1.6rem 3.2rem;
            border-radius: 22px;
            background: rgba(11, 8, 32, 0.7);
            border: 1px solid rgba(248, 250, 252, 0.14);
            box-shadow: 0 18px 45px -25px rgba(9, 7, 24, 0.9);
        }

        .timeline-step::before {
            content: attr(data-step);
            position: absolute;
            left: 1.1rem;
            top: 1.3rem;
            width: 2rem;
            height: 2rem;
            border-radius: 999px;
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            color: #020617;
            font-weight: 700;
            display: grid;
            place-items: center;
            font-family: 'Baloo 2', cursive;
        }

        footer {
            text-align: center;
            padding: 3rem 1rem 4rem;
            color: rgba(248, 250, 252, 0.65);
            font-size: 0.95rem;
        }

        footer a {
            color: var(--secondary);
            text-decoration: none;
            font-weight: 600;
        }

        footer a:hover,
        footer a:focus {
            color: var(--highlight);
        }

        .intel-section {
            position: relative;
            margin: 4.5rem auto;
            padding: clamp(2.8rem, 5vw, 3.6rem);
            border-radius: 32px;
            background: linear-gradient(160deg, rgba(9, 13, 32, 0.9), rgba(22, 32, 64, 0.65));
            border: 1px solid rgba(56, 189, 248, 0.22);
            box-shadow: 0 28px 60px -30px rgba(2, 6, 23, 0.8);
            overflow: hidden;
        }

        .intel-section::before,
        .intel-section::after {
            content: '';
            position: absolute;
            pointer-events: none;
            filter: blur(40px);
            opacity: 0.35;
        }

        .intel-section::before {
            width: 260px;
            height: 260px;
            top: -120px;
            right: -80px;
            background: radial-gradient(circle, rgba(56, 189, 248, 0.65), transparent 65%);
        }

        .intel-section::after {
            width: 220px;
            height: 220px;
            bottom: -110px;
            left: -60px;
            background: radial-gradient(circle, rgba(250, 204, 21, 0.6), transparent 60%);
        }

        .intel-header {
            position: relative;
            z-index: 1;
            display: flex;
            flex-direction: column;
            gap: 0.6rem;
            margin-bottom: 2.2rem;
        }

        .intel-header h2 {
            font-family: 'Baloo 2', cursive;
            font-size: clamp(2.1rem, 4vw, 2.8rem);
            color: var(--highlight);
            margin: 0;
        }

        .intel-header p {
            margin: 0;
            color: var(--text-muted);
            font-size: 1rem;
            max-width: 60ch;
        }

        .intel-grid {
            position: relative;
            z-index: 1;
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
            gap: 1.4rem;
        }

        .intel-card {
            padding: 1.8rem;
            border-radius: 24px;
            background: rgba(8, 12, 28, 0.8);
            border: 1px solid rgba(248, 250, 252, 0.12);
            backdrop-filter: blur(14px);
            display: flex;
            flex-direction: column;
            gap: 0.75rem;
            min-height: 180px;
        }

        .intel-card h3 {
            font-size: 1.05rem;
            color: var(--secondary);
            margin: 0;
        }

        .intel-value {
            font-size: 2rem;
            font-weight: 600;
            color: var(--highlight);
        }

        .intel-metric {
            display: flex;
            align-items: baseline;
            gap: 0.5rem;
            color: var(--text-muted);
            font-size: 0.95rem;
        }

        .intel-badge {
            display: inline-flex;
            align-items: center;
            gap: 0.4rem;
            font-size: 0.8rem;
            padding: 0.35rem 0.8rem;
            border-radius: 999px;
            background: rgba(56, 189, 248, 0.15);
            color: var(--secondary);
            border: 1px solid rgba(56, 189, 248, 0.35);
        }

        .intel-badge.gain {
            background: rgba(34, 197, 94, 0.2);
            color: #86efac;
            border-color: rgba(34, 197, 94, 0.4);
        }

        .intel-badge.loss {
            background: rgba(248, 113, 113, 0.2);
            color: #fca5a5;
            border-color: rgba(248, 113, 113, 0.4);
        }

        .intel-footer {
            margin-top: 2rem;
            font-size: 0.8rem;
            color: rgba(248, 250, 252, 0.55);
        }

        .intel-footer a {
            color: var(--secondary);
            text-decoration: none;
        }

        .intel-footer a:hover,
        .intel-footer a:focus-visible {
            text-decoration: underline;
        }

        @media (max-width: 640px) {
            .intel-card {
                padding: 1.5rem;
            }
        }
    </style>
</head>
<body>
    <header>
        <div class="hero">
            <div class="hero-copy">
                <h1>Forge Legends on the Shahnameh Frontier</h1>
                <p>
                    Rally your guild, grow the kingdom and chart a path through the myths of ancient Persia.
                    Shahnameh Game blends playful strategy with Web3 stewardship so every decision leaves a mark on
                    the eternal chronicle.
                </p>
                <div class="cta-row">
                    <a class="button" href="/api/">
                        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" d="M11.25 6.75h.008v.008H11.25V6.75zM11.25 9h.008v.008H11.25V9zm0 2.25h.008v.008H11.25V11.25zm0 2.25h.008v.008H11.25V13.5zm0 2.25h.008v.008H11.25V15.75zm0 2.25h.008v.008H11.25V18zm2.25-11.25h.008v.008H13.5V6.75zm0 2.25h.008v.008H13.5V9zm0 2.25h.008v.008H13.5V11.25zm0 2.25h.008v.008H13.5V13.5zm0 2.25h.008v.008H13.5V15.75zm0 2.25h.008v.008H13.5V18zm2.25-11.25h.008v.008H15.75V6.75zm0 2.25h.008v.008H15.75V9zm0 2.25h.008v.008H15.75V11.25zm0 2.25h.008v.008H15.75V13.5zm0 2.25h.008v.008H15.75V15.75zm0 2.25h.008v.008H15.75V18z" />
                            <path stroke-linecap="round" stroke-linejoin="round" d="M6.75 7.5l.72-.72a1.5 1.5 0 011.06-.44h7.5A1.5 1.5 0 0117.5 7.5v9a1.5 1.5 0 01-1.5 1.5h-7.5a1.5 1.5 0 01-1.5-1.5V7.5z" />
                        </svg>
                        Explore the API
                    </a>
                    <a class="button secondary" href="{% url 'whitepaper' %}">Read the Whitepaper</a>
                </div>
            </div>
            <div class="hero-visual">
                <div class="hero-card">
                    <h2>Story Season 2: Dawn of the Simurgh</h2>
                    <p>
                        Chart expeditions, tame mythical familiars and unlock cooperative quests to rebuild the House of Knowledge.
                        Every completed saga reshapes the shared roadmap.
                    </p>
                </div>
            </div>
        </div>
    </header>

    <section>
        <div class="section-inner">
            <h2 class="section-title">Why the Chronicle Matters</h2>
            <div class="feature-grid">
                <article class="feature-card">
                    <h3>Living Lore</h3>
                    <p>
                        Weekly chapters ripple across the realm, introducing fresh objectives and collaborative twists
                        inspired by Ferdowsi's timeless poetry.
                    </p>
                </article>
                <article class="feature-card">
                    <h3>Player-Governed Economy</h3>
                    <p>
                        Guild councils steward resources, vote on upgrades and set tribute paths that weave on-chain governance
                        with narrative stakes.
                    </p>
                </article>
                <article class="feature-card">
                    <h3>Adventures for Every Hero</h3>
                    <p>
                        From puzzle raids to social quests, the Shahnameh frontier rewards storytellers, strategists and
                        lorekeepers alike.
                    </p>
                </article>
            </div>
        </div>
    </section>

    <section class="intel-section">
        <div class="section-inner">
            <div class="intel-header">
                <h2>Live TON Intelligence</h2>
                <p>
                    Stay nimble with on-chain telemetry. We surface token price swings, liquidity health and due diligence
                    sentiment directly from TonAPI and DYOR so guild treasurers can react in real time.
                </p>
            </div>
            <div class="intel-grid" id="intel-grid">
                <article class="intel-card" id="ton-price-card">
                    <h3>TON Price</h3>
                    <div class="intel-value" data-ton-price>$--</div>
                    <div class="intel-metric">
                        24h Change:
                        <span class="intel-badge" data-ton-change>--%</span>
                    </div>
                    <p class="intel-metric" data-ton-liquidity>Liquidity data loading…</p>
                </article>
                <article class="intel-card" id="dyor-health-card">
                    <h3>DYOR Project Pulse</h3>
                    <div class="intel-value" data-dyor-score>--%</div>
                    <div class="intel-metric" data-dyor-tier>Awaiting DYOR audit tiers…</div>
                    <p class="intel-metric" data-dyor-updated>Refreshing insights…</p>
                </article>
                <article class="intel-card" id="content-share-card">
                    <h3>Content Contribution</h3>
                    <div class="intel-value" data-content-share>--%</div>
                    <div class="intel-metric">
                        Verified Contributors:
                        <span class="intel-badge" data-contributors>--</span>
                    </div>
                    <p class="intel-metric" data-content-note>Syncing community dashboards…</p>
                </article>
            </div>
            <p class="intel-footer" id="intel-footer">
                Data updates every few minutes straight from
                <a href="https://tonapi.io/" target="_blank" rel="noreferrer">TonAPI</a>
                and
                <a href="https://www.dyor.com/" target="_blank" rel="noreferrer">DYOR Intelligence</a>.
            </p>
        </div>
    </section>

    <section>
        <div class="section-inner">
            <h2 class="section-title">Embark on the Path</h2>
            <div class="timeline">
                <div class="timeline-step" data-step="1">
                    Choose your guild banner, rally companions and claim your district in the Citadel of Tales.
                </div>
                <div class="timeline-step" data-step="2">
                    Complete seasonal quests, unravel riddles from ancient spirits and unlock shared boons for the community.
                </div>
                <div class="timeline-step" data-step="3">
                    Chronicle your victories on-chain to leave an enduring legacy in the ever-expanding Shahnameh codex.
                </div>
            </div>
        </div>
    </section>

    <footer>
        Crafted by the Shahnameh core team · Dive deeper on <a href="{% url 'legacy-overview' %}">our knowledge base</a>
    </footer>

    <script>
        const tonElements = {
            price: document.querySelector('[data-ton-price]'),
            change: document.querySelector('[data-ton-change]'),
            liquidity: document.querySelector('[data-ton-liquidity]'),
        };

        const dyorElements = {
            score: document.querySelector('[data-dyor-score]'),
            tier: document.querySelector('[data-dyor-tier]'),
            updated: document.querySelector('[data-dyor-updated]'),
        };

        const contentElements = {
            share: document.querySelector('[data-content-share]'),
            contributors: document.querySelector('[data-contributors]'),
            note: document.querySelector('[data-content-note]'),
        };

        const formatNumber = (value, options = {}) => {
            const { style = 'decimal', minimumFractionDigits = 2, maximumFractionDigits = 2 } = options;
            try {
                return new Intl.NumberFormat('en-US', {
                    style,
                    minimumFractionDigits,
                    maximumFractionDigits,
                }).format(value);
            } catch (error) {
                console.warn('Formatting error:', error);
                return value;
            }
        };

        const applyFallback = () => {
            tonElements.price.textContent = '$0.00';
            tonElements.change.textContent = '0%';
            tonElements.change.classList.remove('loss', 'gain');
            tonElements.liquidity.textContent = 'Awaiting liquidity feed…';

            dyorElements.score.textContent = 'N/A';
            dyorElements.tier.textContent = 'DYOR ratings currently unavailable.';
            dyorElements.updated.textContent = '';

            contentElements.share.textContent = 'N/A';
            contentElements.contributors.textContent = '--';
            contentElements.note.textContent = 'Community dashboards will populate once DYOR data is reachable.';
        };

        const derivePercentage = (value) => {
            if (value === undefined || value === null || Number.isNaN(Number(value))) {
                return null;
            }

            return Number(value) * (Number(value) <= 1 ? 100 : 1);
        };

        const fetchTonStats = async () => {
            const endpoints = [
                'https://tonapi.io/v2/rates?tokens=toncoin&currencies=usd',
                'https://tonapi.io/v2/explorer/rates?currencies=usd',
            ];

            for (const endpoint of endpoints) {
                try {
                    const response = await fetch(endpoint);
                    if (!response.ok) continue;

                    const data = await response.json();
                    const rates = data?.rates || data?.data?.rates || data;
                    const tonKey = Object.keys(rates || {}).find((key) => key.toLowerCase().includes('ton'));

                    if (!tonKey) continue;

                    const tonData = rates[tonKey];
                    const price =
                        tonData?.prices?.usd ||
                        tonData?.prices?.USD ||
                        tonData?.price_usd ||
                        tonData?.price ||
                        tonData?.value;

                    const change =
                        tonData?.diff_24h?.usd ||
                        tonData?.diff_24h ||
                        tonData?.priceChange24h ||
                        tonData?.change_24h ||
                        tonData?.diff ||
                        0;

                    const liquidity =
                        tonData?.liquidity?.usd ||
                        tonData?.market_liquidity?.usd ||
                        tonData?.liquidity ||
                        null;

                    if (price !== undefined) {
                        tonElements.price.textContent = `$${formatNumber(Number(price), {
                            minimumFractionDigits: 2,
                            maximumFractionDigits: 2,
                        })}`;
                    }

                    if (change !== undefined && change !== null) {
                        const changeValue = Number(change);
                        tonElements.change.textContent = `${changeValue > 0 ? '+' : ''}${formatNumber(changeValue, {
                            minimumFractionDigits: 2,
                            maximumFractionDigits: 2,
                        })}%`;
                        tonElements.change.classList.toggle('gain', changeValue > 0);
                        tonElements.change.classList.toggle('loss', changeValue < 0);
                    }

                    if (liquidity) {
                        tonElements.liquidity.textContent = `Reported liquidity: $${formatNumber(Number(liquidity), {
                            minimumFractionDigits: 0,
                            maximumFractionDigits: 0,
                        })}`;
                    } else {
                        tonElements.liquidity.textContent = 'Liquidity metrics pending fresh updates…';
                    }

                    return;
                } catch (error) {
                    console.warn('TonAPI fetch error', error);
                }
            }
        };

        const fetchDyorStats = async () => {
            const endpoints = [
                'https://api.dyor.io/v1/token/toncoin',
                'https://api.dyor.io/v1/projects/toncoin',
            ];

            for (const endpoint of endpoints) {
                try {
                    const response = await fetch(endpoint);
                    if (!response.ok) continue;

                    const payload = await response.json();
                    const project = payload?.data || payload?.project || payload;
                    if (!project) continue;

                    const score =
                        derivePercentage(project?.scores?.overall) ||
                        derivePercentage(project?.summary?.score) ||
                        derivePercentage(project?.dyor_score);

                    const tier =
                        project?.ratings?.tier ||
                        project?.scores?.tier ||
                        project?.summary?.rating ||
                        project?.risk_level;

                    const updatedAt =
                        project?.updated_at ||
                        project?.last_update ||
                        project?.scores?.updated_at ||
                        project?.summary?.updated_at;

                    const contentPercent =
                        derivePercentage(project?.community?.content_percent) ||
                        derivePercentage(project?.content_percent) ||
                        derivePercentage(project?.metrics?.content_share);

                    const contributors =
                        project?.community?.contributors ||
                        project?.contributors ||
                        project?.metrics?.verified_contributors;

                    if (score !== null) {
                        dyorElements.score.textContent = `${formatNumber(score, {
                            minimumFractionDigits: 1,
                            maximumFractionDigits: 1,
                        })}%`;
                    } else {
                        dyorElements.score.textContent = 'Unrated';
                    }

                    if (tier) {
                        dyorElements.tier.textContent = `Risk tier: ${tier}`;
                    } else {
                        dyorElements.tier.textContent = 'Risk tier awaiting DYOR review.';
                    }

                    if (updatedAt) {
                        const updatedDate = new Date(updatedAt);
                        if (!Number.isNaN(updatedDate.getTime())) {
                            dyorElements.updated.textContent = `Last refreshed ${updatedDate.toLocaleString()}`;
                        }
                    } else {
                        dyorElements.updated.textContent = '';
                    }

                    if (contentPercent !== null) {
                        contentElements.share.textContent = `${formatNumber(contentPercent, {
                            minimumFractionDigits: 1,
                            maximumFractionDigits: 1,
                        })}%`;
                    } else {
                        contentElements.share.textContent = 'N/A';
                    }

                    if (contributors !== undefined) {
                        contentElements.contributors.textContent = formatNumber(Number(contributors), {
                            minimumFractionDigits: 0,
                            maximumFractionDigits: 0,
                        });
                    } else {
                        contentElements.contributors.textContent = '--';
                    }

                    contentElements.note.textContent =
                        contentPercent !== null
                            ? 'Content share reflects vetted creators on DYOR.'
                            : 'Content share data pending next DYOR crawl.';

                    return;
                } catch (error) {
                    console.warn('DYOR fetch error', error);
                }
            }
        };

        const initialiseIntel = async () => {
            applyFallback();
            await Promise.all([fetchTonStats(), fetchDyorStats()]);
        };

        initialiseIntel();
        setInterval(initialiseIntel, 180_000);
    </script>
</body>
</html>
